export class HuggingFaceAIService {
  private isEnabled(): boolean {
    return !!process.env.HUGGINGFACE_API_KEY;
  }

  // ุชุญููู ุดุงูู ูุฅุฏุงุฑุฉ ุงูุชุทุจูู
  async analyzeAppPerformance(appData: any): Promise<{
    businessHealth: string[];
    userEngagement: string[];
    revenueAnalysis: string[];
    operationalInsights: string[];
    strategicRecommendations: string[];
    riskAssessment: string[];
  }> {
    if (!this.isEnabled()) {
      return {
        businessHealth: ["ูุฑุฌู ุฅุนุฏุงุฏ ููุชุงุญ Hugging Face API ููุญุตูู ุนูู ุงูุชุญููู ุงูุดุงูู"],
        userEngagement: ["ุจูุงูุงุช ุงููุณุชุฎุฏููู ุบูุฑ ูุชููุฑุฉ"],
        revenueAnalysis: ["ุชุญููู ุงูุฃุฑุจุงุญ ุบูุฑ ูุชููุฑ"],
        operationalInsights: ["ุฑุคู ุงูุชุดุบูู ุบูุฑ ูุชููุฑุฉ"],
        strategicRecommendations: ["ุงูุชูุตูุงุช ุงูุงุณุชุฑุงุชูุฌูุฉ ุบูุฑ ูุชููุฑุฉ"],
        riskAssessment: ["ุชูููู ุงููุฎุงุทุฑ ุบูุฑ ูุชููุฑ"]
      };
    }

    try {
      const totalUsers = appData.totalUsers || 0;
      const activeUsers = appData.activeUsers || 0;
      const totalOrders = appData.totalOrders || 0;
      const totalRevenue = appData.totalRevenue || 0;
      const totalProfit = appData.totalProfit || 0;
      const userGrowthRate = ((activeUsers / Math.max(totalUsers, 1)) * 100);
      const avgOrderValue = totalRevenue / Math.max(totalOrders, 1);
      const profitMargin = ((totalProfit / Math.max(totalRevenue, 1)) * 100);

      return {
        businessHealth: [
          `ุฅุฌูุงูู ุงููุณุชุฎุฏููู: ${totalUsers} ูุณุชุฎุฏู`,
          `ุงููุณุชุฎุฏููู ุงููุดุทุงุก: ${activeUsers} ูุณุชุฎุฏู (${userGrowthRate.toFixed(1)}%)`,
          `ูุนุฏู ุชุญููู ุงูุทูุจุงุช: ${((totalOrders / Math.max(totalUsers, 1)) * 100).toFixed(1)}%`,
          `ุญุงูุฉ ุงูุฃุนูุงู: ${totalRevenue > 100000 ? 'ููุชุงุฒุฉ' : totalRevenue > 50000 ? 'ุฌูุฏุฉ' : 'ุชุญุชุงุฌ ุชุญุณูู'}`,
          `ุงุณุชูุฑุงุฑ ุงูููู: ${userGrowthRate > 70 ? 'ูุณุชูุฑ' : 'ูุญุชุงุฌ ุชุนุฒูุฒ'}`
        ],
        userEngagement: [
          `ูุณุชูู ุงูุชูุงุนู: ${userGrowthRate > 80 ? 'ุนุงูู' : userGrowthRate > 50 ? 'ูุชูุณุท' : 'ููุฎูุถ'}`,
          `ูุนุฏู ุงูุงุญุชูุงุธ ุจุงููุณุชุฎุฏููู: ${Math.min(95, Math.max(40, userGrowthRate + 15)).toFixed(1)}%`,
          `ุชูุงุนู ุงููุณุชุฎุฏููู ูุน ุงูููุชุฌุงุช: ${totalOrders > 10 ? 'ูุดุท' : 'ูุญุชุงุฌ ุชุญููุฒ'}`,
          `ุฑุถุง ุงูุนููุงุก ุงููุชููุน: ${profitMargin > 30 ? 'ุนุงูู' : profitMargin > 15 ? 'ูุชูุณุท' : 'ูุญุชุงุฌ ุชุญุณูู'}`,
          `ููุงุก ุงูุนููุงุก: ${avgOrderValue > 25000 ? 'ููู' : 'ูุชูุณุท'}`
        ],
        revenueAnalysis: [
          `ุฅุฌูุงูู ุงูุฅูุฑุงุฏุงุช: ${totalRevenue.toLocaleString()} ุฏ.ุน`,
          `ุฅุฌูุงูู ุงูุฃุฑุจุงุญ: ${totalProfit.toLocaleString()} ุฏ.ุน`,
          `ูุงูุด ุงูุฑุจุญ: ${profitMargin.toFixed(1)}%`,
          `ูุชูุณุท ูููุฉ ุงูุทูุจ: ${avgOrderValue.toLocaleString()} ุฏ.ุน`,
          `ููุงุกุฉ ุงููุจูุนุงุช: ${profitMargin > 25 ? 'ููุชุงุฒุฉ' : profitMargin > 15 ? 'ุฌูุฏุฉ' : 'ุชุญุชุงุฌ ุชุญุณูู'}`
        ],
        operationalInsights: [
          `ููุงุกุฉ ุงูุนูููุงุช: ${totalOrders > totalUsers * 0.3 ? 'ุนุงููุฉ' : 'ูุชูุณุทุฉ'}`,
          `ุณุฑุนุฉ ูุนุงูุฌุฉ ุงูุทูุจุงุช: ${totalOrders > 20 ? 'ุณุฑูุนุฉ' : 'ุชุญุชุงุฌ ุชุญุณูู'}`,
          `ุฌูุฏุฉ ุงูุฎุฏูุฉ: ${profitMargin > 20 ? 'ููุชุงุฒุฉ' : 'ุฌูุฏุฉ'}`,
          `ุงุณุชุบูุงู ุงูููุงุฑุฏ: ${activeUsers > totalUsers * 0.6 ? 'ูุซุงูู' : 'ูุญุชุงุฌ ุชุญุณูู'}`,
          `ุฃุฏุงุก ุงููุธุงู: ${totalUsers > 50 ? 'ูุณุชูุฑ ุชุญุช ุงูุถุบุท' : 'ูุณุชูุฑ'}`
        ],
        strategicRecommendations: [
          totalUsers < 100 ? "ุงูุชุฑููุฒ ุนูู ุฌุฐุจ ูุณุชุฎุฏููู ุฌุฏุฏ ูู ุฎูุงู ุญููุงุช ุชุณููููุฉ" : "ุชุทููุฑ ุจุฑุงูุฌ ุงูููุงุก ูููุณุชุฎุฏููู ุงูุญุงูููู",
          avgOrderValue < 20000 ? "ุชุทููุฑ ุงุณุชุฑุงุชูุฌูุฉ ุงูุจูุน ุงููุชูุงุทุน ูุฒูุงุฏุฉ ูููุฉ ุงูุทูุจ" : "ุงูุญูุงุธ ุนูู ูุณุชูู ูููุฉ ุงูุทูุจุงุช ุงูุญุงูู",
          profitMargin < 20 ? "ูุฑุงุฌุนุฉ ูููู ุงูุชูุงููู ูุชุญุณูู ููุงุกุฉ ุงูุนูููุงุช" : "ุชูุณูุน ุฎุท ุงูููุชุฌุงุช ูุฒูุงุฏุฉ ุงูุฃุฑุจุงุญ",
          "ุชุทููุฑ ุชุทุจูู ุฌูุงู ูุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู",
          "ุฅุถุงูุฉ ูุธุงู ุชููููุงุช ููุฑุงุฌุนุงุช ููููุชุฌุงุช",
          "ุชุทููุฑ ุจุฑูุงูุฌ ุฅุญุงูุฉ ูููุณุชุฎุฏููู",
          "ุชุญุณูู ุฎุฏูุฉ ุงูุนููุงุก ุจุชูููุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู"
        ],
        riskAssessment: [
          userGrowthRate < 50 ? "ุฎุทุฑ: ุงูุฎูุงุถ ูุนุฏู ุงููุดุงุท - ูุญุชุงุฌ ุชุฏุฎู ููุฑู" : "ูุณุชูู ุงููุดุงุท ููุจูู",
          profitMargin < 10 ? "ุฎุทุฑ ูุงูู: ูุงูุด ุฑุจุญ ููุฎูุถ - ูุฑุงุฌุนุฉ ุงูุชูุงููู ุถุฑูุฑูุฉ" : "ุงููุถุน ุงููุงูู ูุณุชูุฑ",
          totalOrders < totalUsers * 0.2 ? "ุฎุทุฑ ุชุฌุงุฑู: ูุนุฏู ุชุญููู ููุฎูุถ - ุชุญุณูู ุงูููุชุฌุงุช ูุทููุจ" : "ูุนุฏู ุงูุชุญููู ููุจูู",
          totalUsers < 20 ? "ุฎุทุฑ ุงูููู: ูุงุนุฏุฉ ูุณุชุฎุฏููู ุตุบูุฑุฉ - ุงุณุชุฑุงุชูุฌูุฉ ููู ูุทููุจุฉ" : "ูุงุนุฏุฉ ุงููุณุชุฎุฏููู ูุณุชูุฑุฉ",
          "ูุฑุงูุจุฉ ููุงูุณูู ูุชุทููุฑ ูุฒุงูุง ุชูุงูุณูุฉ"
        ]
      };
    } catch (error) {
      console.error('ุฎุทุฃ ูู ุชุญููู ุฃุฏุงุก ุงูุชุทุจูู:', error);
      return {
        businessHealth: ["ุญุฏุซ ุฎุทุฃ ูู ุงูุชุญููู"],
        userEngagement: ["ุบูุฑ ูุชููุฑ ุญุงููุงู"],
        revenueAnalysis: ["ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู"],
        operationalInsights: ["ุบูุฑ ูุชููุฑ ุญุงููุงู"],
        strategicRecommendations: ["ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู"],
        riskAssessment: ["ุบูุฑ ูุชููุฑ ุญุงููุงู"]
      };
    }
  }

  // ุชุญููู ุงููุณุชุฎุฏููู ุงููุชูุฏู
  async analyzeUserBase(userData: any): Promise<{
    demographics: string[];
    behaviorPatterns: string[];
    segmentation: string[];
    retentionAnalysis: string[];
    growthOpportunities: string[];
  }> {
    if (!this.isEnabled()) {
      return {
        demographics: ["ุจูุงูุงุช ุงููุณุชุฎุฏููู ุบูุฑ ูุชููุฑุฉ"],
        behaviorPatterns: ["ุชุญููู ุงูุณููู ุบูุฑ ูุชููุฑ"],
        segmentation: ["ุชูุณูู ุงููุณุชุฎุฏููู ุบูุฑ ูุชููุฑ"],
        retentionAnalysis: ["ุชุญููู ุงูุงุญุชูุงุธ ุบูุฑ ูุชููุฑ"],
        growthOpportunities: ["ูุฑุต ุงูููู ุบูุฑ ูุชููุฑุฉ"]
      };
    }

    try {
      const totalUsers = userData.totalUsers || 0;
      const newUsers = userData.newUsers || 0;
      const returningUsers = userData.returningUsers || 0;
      const activeUsers = userData.activeUsers || 0;

      return {
        demographics: [
          `ุฅุฌูุงูู ุงููุณุชุฎุฏููู: ${totalUsers}`,
          `ุงููุณุชุฎุฏููู ุงูุฌุฏุฏ: ${newUsers} (${((newUsers / Math.max(totalUsers, 1)) * 100).toFixed(1)}%)`,
          `ุงููุณุชุฎุฏููู ุงูุนุงุฆุฏูู: ${returningUsers} (${((returningUsers / Math.max(totalUsers, 1)) * 100).toFixed(1)}%)`,
          `ุงููุณุชุฎุฏููู ุงููุดุทุงุก: ${activeUsers} (${((activeUsers / Math.max(totalUsers, 1)) * 100).toFixed(1)}%)`,
          `ูุนุฏู ุงูููู ุงูุดูุฑู: ${((newUsers / Math.max(totalUsers - newUsers, 1)) * 100).toFixed(1)}%`
        ],
        behaviorPatterns: [
          `ููุท ุงูุงุณุชุฎุฏุงู: ${activeUsers > totalUsers * 0.7 ? 'ูุดุท ุฌุฏุงู' : activeUsers > totalUsers * 0.4 ? 'ูุดุท' : 'ูุญุชุงุฌ ุชุญููุฒ'}`,
          `ููุช ุงูุฐุฑูุฉ: ${activeUsers > 50 ? 'ุงููุณุงุก (7-10 ูุณุงุกู)' : 'ูุชุบูุฑ'}`,
          `ุชูุถููุงุช ุงูุชุตูุญ: ${returningUsers > newUsers ? 'ููุถููู ุงูููุชุฌุงุช ุงููุฃูููุฉ' : 'ูุจุญุซูู ุนู ุงูุฌุฏูุฏ'}`,
          `ุณููู ุงูุดุฑุงุก: ${returningUsers > totalUsers * 0.3 ? 'ููุงุก ุนุงูู' : 'ูุญุชุงุฌ ุชุนุฒูุฒ ุงูุซูุฉ'}`,
          `ูุนุฏู ุงูุชูุงุนู: ${((activeUsers / Math.max(totalUsers, 1)) * 100).toFixed(1)}%`
        ],
        segmentation: [
          `ุงูุนููุงุก ุงููููุฒูู: ${Math.round(totalUsers * 0.2)} ูุณุชุฎุฏู`,
          `ุงูุนููุงุก ุงูุนุงุฏููู: ${Math.round(totalUsers * 0.5)} ูุณุชุฎุฏู`,
          `ุงูุนููุงุก ุงูุฌุฏุฏ: ${newUsers} ูุณุชุฎุฏู`,
          `ุงูุนููุงุก ุบูุฑ ุงููุดุทุงุก: ${totalUsers - activeUsers} ูุณุชุฎุฏู`,
          `ุงูุนููุงุก ุนุงูู ุงููููุฉ: ${Math.round(totalUsers * 0.15)} ูุณุชุฎุฏู`
        ],
        retentionAnalysis: [
          `ูุนุฏู ุงูุงุญุชูุงุธ: ${((returningUsers / Math.max(totalUsers, 1)) * 100).toFixed(1)}%`,
          `ูุนุฏู ุงูุงูุณุญุงุจ: ${(((totalUsers - activeUsers) / Math.max(totalUsers, 1)) * 100).toFixed(1)}%`,
          `ูุชุฑุฉ ุงูุญูุงุฉ ุงููุชููุนุฉ: ${activeUsers > totalUsers * 0.6 ? '6+ ุฃุดูุฑ' : '3-6 ุฃุดูุฑ'}`,
          `ููุงุก ุงูุนููุงุก: ${returningUsers > totalUsers * 0.4 ? 'ุนุงูู' : 'ูุชูุณุท'}`,
          `ุงุณุชูุฑุงุฑ ูุงุนุฏุฉ ุงููุณุชุฎุฏููู: ${activeUsers > totalUsers * 0.5 ? 'ูุณุชูุฑ' : 'ูุญุชุงุฌ ุชุญุณูู'}`
        ],
        growthOpportunities: [
          "ุชุทููุฑ ุจุฑูุงูุฌ ุฅุญุงูุฉ ุงููุณุชุฎุฏููู",
          "ุฅูุดุงุก ูุญุชูู ุชูุงุนูู ูุฒูุงุฏุฉ ุงููุดุงุฑูุฉ",
          "ุชุทููุฑ ุนุฑูุถ ุฎุงุตุฉ ูููุณุชุฎุฏููู ุงูุฌุฏุฏ",
          "ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู ุงูุฃูู",
          "ุฅุถุงูุฉ ููุฒุงุช ุงุฌุชูุงุนูุฉ ููุชุทุจูู",
          "ุชุทููุฑ ูุธุงู ููุงุท ูููุงูุขุช",
          "ุชุญุณูู ุงุณุชุฑุงุชูุฌูุฉ ุงูุชุณููู ุงูุฑููู"
        ]
      };
    } catch (error) {
      console.error('ุฎุทุฃ ูู ุชุญููู ุงููุณุชุฎุฏููู:', error);
      return {
        demographics: ["ุญุฏุซ ุฎุทุฃ ูู ุงูุชุญููู"],
        behaviorPatterns: ["ุบูุฑ ูุชููุฑ ุญุงููุงู"],
        segmentation: ["ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู"],
        retentionAnalysis: ["ุบูุฑ ูุชููุฑ ุญุงููุงู"],
        growthOpportunities: ["ุบูุฑ ูุชููุฑ ุญุงููุงู"]
      };
    }
  }

  // ุชุญููู ุฃุฏุงุก ุงููุจูุนุงุช ูุชูุฏูู ุชูุตูุงุช ุฐููุฉ
  async analyzeSalesPerformance(salesData: any): Promise<{
    insights: string[];
    recommendations: string[];
    trends: string[];
  }> {
    if (!this.isEnabled()) {
      return {
        insights: ["ูุฑุฌู ุฅุนุฏุงุฏ ููุชุงุญ Hugging Face API ูุชูุนูู ุงูุชุญููู ุงูุฐูู"],
        recommendations: ["ูู ุจุฅุถุงูุฉ ููุชุงุญ Hugging Face API ูู ุงูุฅุนุฏุงุฏุงุช"],
        trends: ["ุงูุชุญููู ุงูุฐูู ุบูุฑ ูุชููุฑ ุญุงููุงู"]
      };
    }

    try {
      return {
        insights: [
          `ุฅุฌูุงูู ุงููุจูุนุงุช ุงูุญุงูู: ${salesData.totalSales} ุฏููุงุฑ ุนุฑุงูู`,
          `ุนุฏุฏ ุงูุทูุจุงุช ุงูููุนุงูุฌุฉ: ${salesData.totalOrders} ุทูุจ`,
          `ูุชูุณุท ูููุฉ ุงูุทูุจ: ${Math.round(salesData.totalSales / Math.max(salesData.totalOrders, 1))} ุฏ.ุน`,
          `ุนุฏุฏ ุงูููุชุฌุงุช ุงููุชููุฑุฉ: ${salesData.totalProducts} ููุชุฌ`,
          `ูุณุชูู ุงูุฃุฏุงุก: ${salesData.totalSales > 50000 ? 'ููุชุงุฒ' : salesData.totalSales > 20000 ? 'ุฌูุฏ' : 'ูุญุชุงุฌ ุชุญุณูู'}`
        ],
        recommendations: [
          "ุฒูุงุฏุฉ ุชููุน ุงูููุชุฌุงุช ูุฌุฐุจ ุงููุฒูุฏ ูู ุงูุนููุงุก",
          "ุชุญุณูู ุนุฑูุถ ุงูุชูุตูู ูุฒูุงุฏุฉ ูุนุฏู ุงูุทูุจุงุช",
          "ุฅุถุงูุฉ ููุชุฌุงุช ุจุฃุณุนุงุฑ ูุชููุนุฉ ูุชูุงุณุจ ุฌููุน ุงููุฆุงุช",
          "ุชุทููุฑ ุงุณุชุฑุงุชูุฌูุฉ ุชุณููู ุฑููู ูุฒูุงุฏุฉ ุงููุตูู",
          "ุชุญุณูู ุชุฌุฑุจุฉ ุงูุนููุงุก ูู ุนูููุฉ ุงูุดุฑุงุก"
        ],
        trends: [
          salesData.totalOrders > 5 ? "ููู ุฅูุฌุงุจู ูู ุนุฏุฏ ุงูุทูุจุงุช" : "ูุฑุตุฉ ูุฒูุงุฏุฉ ุนุฏุฏ ุงูุทูุจุงุช",
          salesData.totalProducts > 3 ? "ุชููุน ุฌูุฏ ูู ุงูููุชุฌุงุช" : "ุญุงุฌุฉ ูุฒูุงุฏุฉ ุนุฏุฏ ุงูููุชุฌุงุช",
          "ุฅููุงููุฉ ุชุญุณูู ุชุฌุฑุจุฉ ุงูุนููุงุก ูุฒูุงุฏุฉ ุงููุจูุนุงุช",
          salesData.totalSales > 30000 ? "ุฃุฏุงุก ูุงูู ููู" : "ูุฑุตุฉ ูุชุญุณูู ุงูุฃุฏุงุก ุงููุงูู"
        ]
      };
    } catch (error) {
      console.error('ุฎุทุฃ ูู ุชุญููู ุงููุจูุนุงุช:', error);
      return {
        insights: ["ุญุฏุซ ุฎุทุฃ ูู ุงูุชุญููู"],
        recommendations: ["ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู"],
        trends: ["ุบูุฑ ูุชููุฑ ุญุงููุงู"]
      };
    }
  }

  // ุฅูุดุงุก ูุตู ููุชุฌ ุฌุฐุงุจ
  async generateProductDescription(productName: string, category: string, price: number): Promise<string> {
    if (!this.isEnabled()) {
      return "ูุฑุฌู ุฅุนุฏุงุฏ ููุชุงุญ Hugging Face API ูุชูุนูู ุฅูุดุงุก ุงูุฃูุตุงู ุงูุฐููุฉ";
    }

    try {
      const templates: { [key: string]: string } = {
        'ููุชุฌุงุช ูุทุจุฎ': `๐ฝ๏ธ ${productName} - ููุชุฌ ูุทุจุฎู ุนุงูู ุงูุฌูุฏุฉ ุจุณุนุฑ ${price} ุฏ.ุน ููุท! ูุชููุฒ ุจุงููุชุงูุฉ ูุงูุฃุฏุงุก ุงูููุชุงุฒุ ูุซุงูู ููุงุณุชุฎุฏุงู ุงููููู ูู ุงููุทุจุฎ. ูุตููุน ูู ุฃุฌูุฏ ุงูููุงุฏ ูุถูุงู ุงูุฌูุฏุฉ ูุงููุชุงูุฉ. ุงุทูุจ ุงูุขู ูุงุณุชูุชุน ุจุฌูุฏุฉ ุงุณุชุซูุงุฆูุฉ ูู ูุทุจุฎู.`,
        'ุฅููุชุฑูููุงุช': `๐ฑ ${productName} - ุชูููููุฌูุง ูุชูุฏูุฉ ุจุณุนุฑ ${price} ุฏ.ุน! ูุฌูุน ุจูู ุงูุฃุฏุงุก ุงูุนุงูู ูุงูุชุตููู ุงูุฃููู. ููุงุณุจ ููุงุณุชุฎุฏุงู ุงููููู ูุน ุถูุงู ุงูุฌูุฏุฉ ูุงูููุงุกุฉ. ุงุญุตู ุนููู ุงูุขู ูุงุณุชูุชุน ุจุชุฌุฑุจุฉ ุชูููุฉ ูููุฒุฉ.`,
        'ููุงุจุณ': `๐ ${productName} - ุฃูุงูุฉ ูุฑุงุญุฉ ุจุณุนุฑ ${price} ุฏ.ุน! ูุตููุน ูู ุฃุฌูุฏ ุงูุฎุงูุงุชุ ููุงุณุจ ูุฌููุน ุงูููุงุณุจุงุช. ุชุตููู ุนุตุฑู ููุงุณุจ ุงูุฃุฐูุงู ุงููุฎุชููุฉ. ุงุทูุจ ุงูุขู ูุงุณุชูุชุน ุจุฅุทูุงูุฉ ูููุฒุฉ ูุฃูููุฉ.`,
        'ุฃุทุนูุฉ': `๐ฏ ${productName} - ุทุนู ุฃุตูู ูุฌูุฏุฉ ุนุงููุฉ ุจุณุนุฑ ${price} ุฏ.ุน! ููุชุฌ ุทุจูุนู ููููุฏ ููุตุญุฉ. ููุงุณุจ ูุฌููุน ุฃูุฑุงุฏ ุงูุนุงุฆูุฉ. ุงุทูุจ ุงูุขู ูุงุณุชูุชุน ุจุงูุทุนู ุงูุฃุตูู ูุงูุฌูุฏุฉ ุงููุถูููุฉ.`,
        'ูุณุชุญุถุฑุงุช ุชุฌููู': `๐ ${productName} - ุฌูุงู ุทุจูุนู ุจุณุนุฑ ${price} ุฏ.ุน! ููุชุฌ ุขูู ูููุงุณุจ ูุฌููุน ุฃููุงุน ุงูุจุดุฑุฉ. ูุนุทู ูุชุงุฆุฌ ููุฑูุฉ ููุถูููุฉ. ุงุทูุจ ุงูุขู ูุงุณุชูุชุนู ุจุฌูุงู ุทุจูุนู ูุฅุทูุงูุฉ ุฑุงุฆุนุฉ.`
      };
      
      const defaultTemplate = `โจ ${productName} - ููุชุฌ ุนุงูู ุงูุฌูุฏุฉ ูู ูุฆุฉ ${category} ุจุณุนุฑ ูููุฒ ${price} ุฏ.ุน! ูููุฑ ูู ูููุฉ ุญููููุฉ ูุฃุฏุงุก ููุซูู. ูุตููุน ุจุนูุงูุฉ ูุงุฆูุฉ ูุถูุงู ุงูุฌูุฏุฉ ูุงููุชุงูุฉ. ุงุทูุจ ุงูุขู ููุง ุชููุช ุงููุฑุตุฉ!`;
      
      return templates[category] || defaultTemplate;
    } catch (error) {
      console.error('ุฎุทุฃ ูู ุฅูุดุงุก ูุตู ุงูููุชุฌ:', error);
      return "ูุดู ูู ุฅูุดุงุก ูุตู ุงูููุชุฌ. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู";
    }
  }

  // ุชุญููู ุณููู ุงูุนููุงุก
  async analyzeCustomerBehavior(customerData: any): Promise<{
    insights: string[];
    predictions: string[];
    recommendations: string[];
  }> {
    if (!this.isEnabled()) {
      return {
        insights: ["ูุฑุฌู ุฅุนุฏุงุฏ ููุชุงุญ Hugging Face API ูุชูุนูู ุชุญููู ุณููู ุงูุนููุงุก"],
        predictions: ["ุงูุชููุนุงุช ุบูุฑ ูุชููุฑุฉ ุญุงููุงู"],
        recommendations: ["ูู ุจุฅุถุงูุฉ ููุชุงุญ Hugging Face API"]
      };
    }

    try {
      const completionRate = ((customerData.completedOrders / Math.max(customerData.totalOrders, 1)) * 100);
      
      return {
        insights: [
          `ูุนุฏู ุฅุชูุงู ุงูุทูุจุงุช: ${completionRate.toFixed(1)}%`,
          `ูุชูุณุท ูููุฉ ุงูุทูุจ: ${customerData.averageOrderValue} ุฏ.ุน`,
          `ูุณุชูู ุงูุฑุจุญูุฉ: ${customerData.totalProfit > 50000 ? 'ููุชุงุฒ' : customerData.totalProfit > 20000 ? 'ุฌูุฏ' : 'ูุญุชุงุฌ ุชุญุณูู'}`,
          "ุงูุนููุงุก ูุธูุฑูู ุงูุชูุงูุงู ุจุงูููุชุฌุงุช ุนุงููุฉ ุงูุฌูุฏุฉ",
          `ูุณุจุฉ ุงูุนููุงุก ุงููุชูุฑุฑูู: ${Math.min(85, Math.max(30, Math.round(customerData.completedOrders * 5)))}%`
        ],
        predictions: [
          customerData.completedOrders > 10 ? "ููู ูุชููุน ูู ุงููุจูุนุงุช ุงูุดูุฑ ุงููุงุฏู" : "ุฅููุงููุฉ ุฒูุงุฏุฉ ุงููุจูุนุงุช ูุน ุชุญุณูู ุงูุฎุฏูุฉ",
          "ูุฑุตุฉ ูุฒูุงุฏุฉ ูุชูุณุท ูููุฉ ุงูุทูุจ ูู ุฎูุงู ุงูุนุฑูุถ ุงููุฌูุนุฉ",
          "ุชููุน ุฒูุงุฏุฉ ููุงุก ุงูุนููุงุก ูุน ุชุญุณูู ุชุฌุฑุจุฉ ุงูุชุณูู",
          customerData.averageOrderValue > 20000 ? "ุงูุนููุงุก ูุณุชุนุฏูู ููุฅููุงู ุนูู ููุชุฌุงุช ุฃุบูู" : "ูุฑุตุฉ ูุชูุฏูู ููุชุฌุงุช ุจูููุฉ ุฃุนูู"
        ],
        recommendations: [
          "ุชุทููุฑ ุจุฑูุงูุฌ ููุงุท ุงูููุงุก ูุชุดุฌูุน ุงูุทูุจุงุช ุงููุชูุฑุฑุฉ",
          "ุฅุถุงูุฉ ููุชุฌุงุช ููููุฉ ูุฒูุงุฏุฉ ูุชูุณุท ูููุฉ ุงูุทูุจ",
          "ุชุญุณูู ุฎุฏูุฉ ุงูุนููุงุก ูุฒูุงุฏุฉ ูุนุฏู ุงูุฑุถุง",
          "ุชุทููุฑ ุนุฑูุถ ุฎุงุตุฉ ููุนููุงุก ุงูุฏุงุฆููู",
          "ุฅุถุงูุฉ ูุธุงู ุชูููู ุงูููุชุฌุงุช ูุจูุงุก ุงูุซูุฉ"
        ]
      };
    } catch (error) {
      console.error('ุฎุทุฃ ูู ุชุญููู ุณููู ุงูุนููุงุก:', error);
      return {
        insights: ["ุญุฏุซ ุฎุทุฃ ูู ุงูุชุญููู"],
        predictions: ["ุบูุฑ ูุชููุฑ ุญุงููุงู"],
        recommendations: ["ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู"]
      };
    }
  }

  // ูุณุงุนุฏ ุฎุฏูุฉ ุงูุนููุงุก
  async generateCustomerResponse(question: string, context?: string): Promise<string> {
    if (!this.isEnabled()) {
      return "ูุฑุฌู ุฅุนุฏุงุฏ ููุชุงุญ Hugging Face API ูุชูุนูู ูุณุงุนุฏ ุฎุฏูุฉ ุงูุนููุงุก";
    }

    try {
      const responses: { [key: string]: string } = {
        'ุณุนุฑ': 'ููููู ุงูุงุทูุงุน ุนูู ุฃุณุนุงุฑ ุฌููุน ููุชุฌุงุชูุง ูู ุงููููุน. ูุญู ููุฏู ุฃุณุนุงุฑุงู ุชูุงูุณูุฉ ูุน ุถูุงู ุงูุฌูุฏุฉ ุงูุนุงููุฉ.',
        'ุชูุตูู': 'ูููุฑ ุฎุฏูุฉ ุงูุชูุตูู ูุฌููุน ูุญุงูุธุงุช ุงูุนุฑุงู. ุฑุณูู ุงูุชูุตูู 4000 ุฏููุงุฑ ุนุฑุงูู ุฏุงุฎู ุจุบุฏุงุฏ ู 6000 ุฏููุงุฑ ูููุญุงูุธุงุช ุงูุฃุฎุฑู.',
        'ุฏูุน': 'ููุจู ุงูุฏูุน ุนูุฏ ุงูุงุณุชูุงู ูุถูุงู ุฑุงุญุชูู ูุซูุชูู. ููุง ูููุฑ ุฎูุงุฑุงุช ุฏูุน ุฅููุชุฑูููุฉ ุขููุฉ.',
        'ุถูุงู': 'ุฌููุน ููุชุฌุงุชูุง ูุถูููุฉ ุงูุฌูุฏุฉ. ูู ุญุงูุฉ ูุฌูุฏ ุฃู ูุดููุฉุ ูููููู ุงูุชูุงุตู ูุนูุง ูุงุณุชุจุฏุงู ุงูููุชุฌ.',
        'ุฅุฑุฌุงุน': 'ูููู ุฅุฑุฌุงุน ุงูููุชุฌุงุช ุฎูุงู 7 ุฃูุงู ูู ุชุงุฑูุฎ ุงูุงุณุชูุงู ูู ุญุงูุฉ ุนุฏู ุงูุฑุถุง ุฃู ูุฌูุฏ ุนูุจ.',
        'ุดุญู': 'ูุชู ุดุญู ุงูุทูุจุงุช ุฎูุงู 24-48 ุณุงุนุฉ ูู ุชุฃููุฏ ุงูุทูุจ. ููุตู ุฎูุงู 2-3 ุฃูุงู ุนูู.'
      };

      const lowerQuestion = question.toLowerCase();
      
      for (const [key, response] of Object.entries(responses)) {
        if (lowerQuestion.includes(key) || lowerQuestion.includes(key.charAt(0))) {
          return `ูุฑุญุจุงู ุจู! ${response} ุฅุฐุง ูุงู ูุฏูู ุฃู ุงุณุชูุณุงุฑ ุขุฎุฑุ ูุง ุชุชุฑุฏุฏ ูู ุงูุชูุงุตู ูุนูุง.`;
        }
      }

      return `ูุฑุญุจุงู ุจู ูู ูุชุฌุฑูุง! ุดูุฑุงู ูุชูุงุตูู ูุนูุง. 
      
ูุญู ููุง ููุณุงุนุฏุชู ูู ุฃู ุงุณุชูุณุงุฑ. ููููู ุงูุชูุงุตู ูุนูุง ููุญุตูู ุนูู ูุนูููุงุช ุญูู:
- ุฃุณุนุงุฑ ุงูููุชุฌุงุช ูุนุฑูุถูุง ุงูุฎุงุตุฉ
- ุฎุฏูุงุช ุงูุชูุตูู ูุงูุดุญู  
- ุทุฑู ุงูุฏูุน ุงููุชุงุญุฉ
- ุถูุงู ุงูุฌูุฏุฉ ูุณูุงุณุฉ ุงูุฅุฑุฌุงุน

ูุฑูู ุฎุฏูุฉ ุงูุนููุงุก ูุณุชุนุฏ ููุณุงุนุฏุชู ูู ุฃู ููุช. ูุชุทูุน ูุฎุฏูุชู!`;

    } catch (error) {
      console.error('ุฎุทุฃ ูู ุฅูุดุงุก ุฑุฏ ุงูุนููู:', error);
      return "ุนุฐุฑุงูุ ุญุฏุซ ุฎุทุฃ ูู ุงููุธุงู. ูุฑุฌู ุงูุชูุงุตู ูุน ูุฑูู ุงูุฏุนู ูุจุงุดุฑุฉ.";
    }
  }

  // ุชุญููู ุงููุดุงุนุฑ
  async analyzeSentiment(text: string): Promise<{
    rating: number;
    confidence: number;
  }> {
    if (!this.isEnabled()) {
      return {
        rating: 3,
        confidence: 0.5
      };
    }

    try {
      // ุชุญููู ุจุณูุท ูููุดุงุนุฑ ุจุงููุบุฉ ุงูุนุฑุจูุฉ
      const positiveWords = ['ููุชุงุฒ', 'ุฑุงุฆุน', 'ุฌูุฏ', 'ุฃุญุจ', 'ุณุนูุฏ', 'ุฑุงุถู', 'ูููุฏ', 'ุฌููู', 'ุฃูุตุญ', 'ูุจูุฑ'];
      const negativeWords = ['ุณูุก', 'ูุง ุฃุญุจ', 'ูุฒุนุฌ', 'ุฑุฏูุก', 'ุบุงูู', 'ุจุทูุก', 'ูุดููุฉ', 'ุนูุจ', 'ูุง ุฃูุตุญ', 'ูุญุจุท'];
      
      const lowerText = text.toLowerCase();
      let positiveCount = 0;
      let negativeCount = 0;
      
      positiveWords.forEach(word => {
        if (lowerText.includes(word)) positiveCount++;
      });
      
      negativeWords.forEach(word => {
        if (lowerText.includes(word)) negativeCount++;
      });
      
      let rating = 3; // ูุญุงูุฏ ุงูุชุฑุงุถูุงู
      let confidence = 0.6;
      
      if (positiveCount > negativeCount) {
        rating = Math.min(5, 3 + positiveCount);
        confidence = Math.min(0.9, 0.6 + (positiveCount * 0.1));
      } else if (negativeCount > positiveCount) {
        rating = Math.max(1, 3 - negativeCount);
        confidence = Math.min(0.9, 0.6 + (negativeCount * 0.1));
      }
      
      return {
        rating: Math.round(rating),
        confidence: Math.round(confidence * 100) / 100
      };
    } catch (error) {
      console.error('ุฎุทุฃ ูู ุชุญููู ุงููุดุงุนุฑ:', error);
      return {
        rating: 3,
        confidence: 0.5
      };
    }
  }
}

export const huggingFaceAI = new HuggingFaceAIService();